"use strict";(self.webpackChunkdatalayer_docs=self.webpackChunkdatalayer_docs||[]).push([[7734],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(n),d=r,f=m["".concat(l,".").concat(d)]||m[d]||u[d]||i;return n?a.createElement(f,o(o({ref:t},p),{},{components:n})):a.createElement(f,o({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[m]="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7503:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const i={id:"estimate-fees",title:"Estimate Fees",sidebar_position:2},o=void 0,s={unversionedId:"dev-resources/APIReference/estimate-fees",id:"dev-resources/APIReference/estimate-fees",title:"Estimate Fees",description:"Estimates the fees to be sent when calling outbound method on the contract. The fees to be paid are in the native token of the source chain. The fees can be calculated off-chain as well as on-chain, making SocketDL a smart contract first messaging protocol.",source:"@site/docs/dev-resources/APIReference/EstimateFee.md",sourceDirName:"dev-resources/APIReference",slug:"/dev-resources/APIReference/estimate-fees",permalink:"/dev-resources/APIReference/estimate-fees",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"estimate-fees",title:"Estimate Fees",sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Check Connection",permalink:"/dev-resources/APIReference/check-connection"},next:{title:"Track Message Status",permalink:"/dev-resources/APIReference/track-status"}},l={},c=[{value:"On-chain",id:"on-chain",level:2},{value:"Example",id:"example",level:4},{value:"Off-chain API",id:"off-chain-api",level:2},{value:"Example Request",id:"example-request",level:4},{value:"Response Parameters",id:"response-parameters",level:4}],p={toc:c},m="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Estimates the fees to be sent when calling ",(0,r.kt)("inlineCode",{parentName:"p"},"outbound")," method on the contract. The fees to be paid are in the native token of the source chain. The fees can be calculated off-chain as well as on-chain, making SocketDL a smart contract first messaging protocol."),(0,r.kt)("h2",{id:"on-chain"},"On-chain"),(0,r.kt)("p",null,"The fees for relaying messages can be calculated on-chain by calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"getMinFees()")," method on Socket. The method can be inherited in your contract from the ",(0,r.kt)("a",{parentName:"p",href:"/dev-resources/Interfaces/ISocket"},"ISocket")," interface. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"    interface ISocket {\n        function getMinFees(\n            uint256 minMsgGasLimit_,\n            uint256 payloadSize_,\n            bytes32 executionParams_,\n            bytes32 transmissionParams_,\n            uint32 remoteChainSlug_,\n            address plug_\n        ) external view returns (uint256 totalFees);\n    }\n")),(0,r.kt)("h4",{id:"example"},"Example"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/SocketDotTech/socketDL-examples/blob/main/src/SpeedRunDL/SocketSpeedRunGoerli.sol"},"The SpeedRunDL example contract")," fetches the fee on-chain and checks if the fee sent from the user is correct."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"    function _getMinimumFees(\n        uint256 msgGasLimit_,\n        uint32 _remoteChainSlug\n    ) internal view returns (uint256) {\n        return\n            ISocket(socket).getMinFees(\n                msgGasLimit_,\n                _remoteChainSlug,\n                address(this)\n            );\n    }\n\n    function sendMessage() external payable {\n        uint256 totalFees = _getMinimumFees(destGasLimit, remoteChainSlug);\n\n        if (msg.value < totalFees) revert InsufficientFees();\n\n        // ... remaining code\n    }\n")),(0,r.kt)("h2",{id:"off-chain-api"},"Off-chain API"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"GET"))," ",(0,r.kt)("a",{parentName:"p",href:"https://prod.dlapi.socket.tech/estimate-min-fees"},"https://prod.dlapi.socket.tech/v1/estimate-min-fees")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Header"),":  x-api-key : 2Va1n3HzAS5XfXB8ELhX1aATJwzA1A72sNnJE1a0"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Query Param"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"srcPlug")),(0,r.kt)("td",{parentName:"tr",align:null},"Address of source Plug")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"srcChainSlug")),(0,r.kt)("td",{parentName:"tr",align:null},"Slug of source chain")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"dstChainSlug")),(0,r.kt)("td",{parentName:"tr",align:null},"Slug of destination chain")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"msgGasLimit")),(0,r.kt)("td",{parentName:"tr",align:null},"Gas limit required for executing the destination payload")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"payloadLength")),(0,r.kt)("td",{parentName:"tr",align:null},"Length of payload to be executed on destination plug")))),(0,r.kt)("h4",{id:"example-request"},"Example Request"),(0,r.kt)("p",null,"Estimating fees for sending a message from Polygon to Optimism "),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://prod.dlapi.socket.tech/estimate-min-fees?srcPlug=0x7b9ed5C43E87DAFB03211651d4FA41fEa1Eb9b3D&srcChainSlug=2999&dstChainSlug=10&msgGasLimit=100000&payloadLength=100"},"https://prod.dlapi.socket.tech/v1/estimate-min-fees?srcPlug=0x7b9ed5C43E87DAFB03211651d4FA41fEa1Eb9b3D&srcChainSlug=2999&dstChainSlug=10&msgGasLimit=100000&payloadLength=100")),(0,r.kt)("p",null,"Note : Add the ",(0,r.kt)("em",{parentName:"p"},"x-api-key")," header mentioned above in the request for authentication. "),(0,r.kt)("h4",{id:"response-parameters"},"Response Parameters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"result")),(0,r.kt)("td",{parentName:"tr",align:null},"Total fees to be paid in the native token of the source chain")))))}u.isMDXComponent=!0}}]);